/*! Volksoper - v0.1.0 - 2012-12-29
* http://PROJECT_WEBSITE/
* Copyright (c) 2012 tshinsay; Licensed MIT */
var volksoper;(function(e){var t=function(){function e(e){this._type=e,this._propagates=!0,this._stopImmediate=!1}return e.ADDED="added",e.REMOVE="remove",Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"propagates",{get:function(){return this._propagates},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stopImmediate",{get:function(){return this._stopImmediate},enumerable:!0,configurable:!0}),e.prototype.stopPropagation=function(){this._propagates=!1},e.prototype.stopPropagationImmediate=function(){this._propagates=!1,this._stopImmediate=!0},e}();e.Event=t})(volksoper||(volksoper={}));var volksoper;(function(e){var t=function(){function t(){}return t._handlerNameTable={},t.prototype.addChild=function(t){this._children=this._children||[],t._parent=this,this._children.push(t),t.propagateEvent(new e.Event(e.Event.ADDED))},t.prototype.removeChild=function(t){if(!this._children)return!1;var n=this._children.indexOf(t);return n>=0?(t.propagateEvent(new e.Event(e.Event.REMOVE)),this._children.splice(n,1),t._parent=null,!0):!1},t.prototype.popChild=function(){var t=this.topChild;return t?(t.propagateEvent(new e.Event(e.Event.REMOVE)),this._children.pop(),t._parent=null,t):null},Object.defineProperty(t.prototype,"topChild",{get:function(){return!this._children||this._children.length==0?null:this._children[this._children.length-1]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numChildren",{get:function(){return this._children?this._children.length:0},enumerable:!0,configurable:!0}),t.prototype.sortChildren=function(e){this._children=this._children||[],this._children.sort(e)},t.prototype.getChild=function(e){return this._children==null?null:this._children[e]},t.prototype.addEventListener=function(e,n,r,i){r?this._captureHandlers=t._registerListener(this._captureHandlers,e,n,i):this._bubbleHandlers=t._registerListener(this._bubbleHandlers,e,n,i)},t.prototype.removeEventListener=function(e,n,r){return r?t._removeHandler(this._captureHandlers,e,n):t._removeHandler(this._bubbleHandlers,e,n)},t._removeHandler=function(t,n,r){if(!t)return!1;var i=t[n];for(var s in i){var o=i[s].handler;if(o===r)return i.splice(s,1),!0}return!1},t._registerListener=function(t,n,r,i){return i=i||0,t=t||{},n in t||(t[n]=[]),t[n].push({priority:i,handler:r}),t[n].sort(function(e,t){return t.priority-e.priority}),t},t.prototype.dispatchEvent=function(e){return this._handleEvent(e,this,!1)},t.prototype.propagateEvent=function(e){var t=!1,n=[this],r=this,i=0;while(r=r._parent)n.push(r);var s=n.length;for(i=s-1;i>=0;i--){t=n[i]._handleEvent(e,this,!0)||t;if(!e.propagates)return t}for(i=0;i<s;i++){t=n[i]._handleEvent(e,this,!1)||t;if(!e.propagates)return t}return t},t.prototype.broadcastEvent=function(e){var t=!1;t=this._handleEvent(e,null,!1)||t;if(this._children)for(var n=0;n<this._children.length;++n)t=this._children[n].broadcastEvent(e)||t;return t},t.prototype._handleEvent=function(e,t,n){e.currentTarget=this,e.target=t;if(!n&&this._callHandler(e)&&e.stopImmediate)return!0;var r=e.type,i;n&&this._captureHandlers?i=this._captureHandlers[r]:!n&&this._bubbleHandlers&&(i=this._bubbleHandlers[r]);if(!i||i.length==0)return!1;for(var s in i){var o=i[s].handler;e.currentTarget=this,e.target=t,o(e);if(e.stopImmediate)break}return!0},t.prototype._callHandler=function(e){var n=t._handlerNameTable[e.type]||t._getHandlerName(e);return this[n]?(this[n](e),!0):!1},t._getHandlerName=function(n){var r=n.type,i="on"+r.charAt(0).toUpperCase()+r.substr(1);return t._handlerNameTable[r]=i,i},t}();e.Actor=t})(volksoper||(volksoper={}));var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},volksoper;(function(e){var t=function(t){function n(){t.call(this),this._wrapper={},this._registry={};var n=this;this.addEventListener(e.Event.ADDED,function(e){n._registerTarget(e.target)},!0),this.addEventListener(e.Event.REMOVE,function(e){n._unregisterTarget(e.target)},!0)}return __extends(n,t),n.prototype._registerTarget=function(e){this._getTable(e).push(e),this._registerWrapper(e)},n.prototype._registerWrapper=function(e){var t=this._wrapper[e.prototype.constructor],r=this._getTable(e);t||(t=n._createWrapper(e,r),this._wrapper[e.prototype.constructor]=t)},n._createWrapper=function(t,r){var i={};for(var s in t){var o=t[s];typeof o=="function"&&(i[s]=n._wrapMethod(r,s,i))}return i},n._wrapMethod=function(t,n,r){return function(){for(var e in t)t[e][n].apply(t[e],arguments);return r}},n.prototype._getTable=function(e){var t=this._registry[e.prototype.constructor];return t||(this._registry[e.prototype.constructor]=t=[]),t},n.prototype._unregisterTarget=function(e){var t=this._getTable(e);t.splice(t.indexOf(e),1)},n.prototype.find=function(e){return this._registry[e]=this._registry[e]||[]},n.prototype.query=function(e){return this._wrapper[e]},n}(e.Actor);e.Scene=t})(volksoper||(volksoper={}));