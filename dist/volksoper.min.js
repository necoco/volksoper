/*! Volksoper - v0.1.0 - 2013-01-01
* http://PROJECT_WEBSITE/
* Copyright (c) 2013 tshinsay; Licensed MIT */
var volksoper;(function(e){var t=function(){function e(e){this._type=e,this._propagates=!0,this._stopImmediate=!1}return e.ADDED="added",e.REMOVE="remove",e.ADDED_TO_SCENE="addedToScene",e.REMOVE_FROM_SCENE="removeFromScene",e.ADDED_TO_STAGE="addedToStage",e.REMOVE_FROM_STAGE="removeFromScene",e.COMPLETE="complete",e.LOADED="loaded",Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"propagates",{get:function(){return this._propagates},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stopImmediate",{get:function(){return this._stopImmediate},enumerable:!0,configurable:!0}),e.prototype.stopPropagation=function(){this._propagates=!1},e.prototype.stopPropagationImmediate=function(){this._propagates=!1,this._stopImmediate=!0},e}();e.Event=t})(volksoper||(volksoper={}));var volksoper;(function(e){e.SYSTEM_PRIORITY=1e8;var t=function(){function t(){this._forEach=0}return t._handlerNameTable={},Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),t.prototype.addChild=function(t){this._children=this._children||[],t._parent=this,this._children.push(t),t.propagateEvent(new e.Event(e.Event.ADDED))},t.prototype.removeChild=function(t){if(!this._children)return!1;if(this._forEach!==0)return this._toRemove=this._toRemove||[],this._toRemove.push(t),!0;var n=this._children.indexOf(t);return n>=0?(t.propagateEvent(new e.Event(e.Event.REMOVE)),this._children.splice(n,1),t._parent=null,!0):!1},t.prototype.popChild=function(){var t=this.topChild;return t?(t.propagateEvent(new e.Event(e.Event.REMOVE)),this._children.pop(),t._parent=null,t):null},t.prototype.swapTop=function(e){var t=this.popChild();return t&&this.addChild(e),t},Object.defineProperty(t.prototype,"topChild",{get:function(){return!this._children||this._children.length==0?null:this._children[this._children.length-1]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numChildren",{get:function(){return this._children?this._children.length:0},enumerable:!0,configurable:!0}),t.prototype.sortChildren=function(e){this._children=this._children||[],this._children.sort(e)},t.prototype.getChild=function(e){return this._children==null?null:this._children[e]},t.prototype.addEventListener=function(e,n,r,i){r?this._captureHandlers=t._registerListener(this._captureHandlers,e,n,i):this._bubbleHandlers=t._registerListener(this._bubbleHandlers,e,n,i)},t.prototype.removeEventListener=function(e,n,r){return r?t._removeHandler(this._captureHandlers,e,n):t._removeHandler(this._bubbleHandlers,e,n)},t._removeHandler=function(t,n,r){if(!t)return!1;var i=t[n];for(var s in i){var o=i[s].handler;if(o===r)return i.splice(s,1),!0}return!1},t._registerListener=function(t,n,r,i){return i=i||0,t=t||{},n in t||(t[n]=[]),t[n].push({priority:i,handler:r}),t[n].sort(function(e,t){return t.priority-e.priority}),t},t.prototype.dispatchEvent=function(e){return this._handleEvent(e,this,!1)},t.prototype.propagateEvent=function(e){var t=!1,n=[this],r=this,i=0;while(r=r._parent)n.push(r);var s=n.length;for(i=s-1;i>=0;i--){t=n[i]._handleEvent(e,this,!0)||t;if(!e.propagates)return t}for(i=0;i<s;i++){t=n[i]._handleEvent(e,this,!1)||t;if(!e.propagates)return t}return t},t.prototype.broadcastEvent=function(e,t){return this._broadcastEvent(e,t?t:this)},t.prototype._broadcastEvent=function(e,t){var n=!1;return n=this._handleEvent(e,t,!1)||n,this.forEachChild(function(r){n=r._broadcastEvent(e,t)||n}),n},t.prototype.broadcast=function(e){var t=[];for(var n=0;n<arguments.length-1;n++)t[n]=arguments[n+1];e in this&&this[e].call(this,t),this.forEachChild(function(n){n.broadcast(e,t)})},t.prototype.forEachChild=function(e,t){this._forEach++;if(this._children){var n=this._children.length,r=0;if(t){for(r=n-1;r>=0;--r)if(e(this._children[r]))break}else for(r=0;r<n;++r)if(e(this._children[r]))break}this._forEach--;if(this._forEach===0){var i=this._toRemove;if(i){var s=i.length;for(var o=0;o<s;o++)this.removeChild(i[o]);i.splice(0)}}},t.prototype._handleEvent=function(e,t,n){e.currentTarget=this,e.target=t;if(!n&&this._callHandler(e)&&e.stopImmediate)return!0;var r=e.type,i;n&&this._captureHandlers?i=this._captureHandlers[r]:!n&&this._bubbleHandlers&&(i=this._bubbleHandlers[r]);if(!i||i.length==0)return!1;for(var s in i){var o=i[s].handler;e.currentTarget=this,e.target=t,o(e);if(e.stopImmediate)break}return!0},t.prototype._callHandler=function(e){var n=t._handlerNameTable[e.type]||t._getHandlerName(e);return this[n]?(this[n](e),!0):!1},t._getHandlerName=function(n){var r=n.type,i="on"+r.charAt(0).toUpperCase()+r.substr(1);return t._handlerNameTable[r]=i,i},t}();e.Actor=t})(volksoper||(volksoper={}));var volksoper;(function(e){var t=function(){function e(e,t,n){this.x=e,this.y=t,this.z=n,this.x=e||0,this.y=t||0,this.z=n||0}return e.prototype.normalize=function(){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);return e===0?!1:(this.x/=e,this.y/=e,this.z/=e,!0)},e.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},e.prototype.dot=function(e){return this.x*e.x+this.y*e.y+this.z*e.z},e.prototype.cross=function(e,t){return this.x=e.y*t.z-e.z*t.y,this.y=e.z*t.x-e.x*t.z,this.z=e.x*t.y-e.y*t.x,this},e}();e.Vector3=t})(volksoper||(volksoper={}));var volksoper;(function(e){var t=function(){function e(e){this.m=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e&&this.setValue(e)}return e.IDENT=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e.TMP=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e.TMP_MAT=new e,e.prototype.setValue=function(e){var t=this.m,n=e.m;for(var r=0;r<16;++r)t[r]=n[r]},e.prototype.translate=function(e,t,n){var r=this.m;return r[12]+=e,r[13]+=t,r[14]+=n,this},e.prototype.rotate=function(t,n,r){var i=e.TMP_MAT.m;e.TMP_MAT.identify();var s=Math.cos(t),o=Math.cos(n),u=Math.cos(r),a=Math.sin(t),f=Math.sin(n),l=Math.sin(r);return i[0]=o*u,i[1]=a*f*u-s*l,i[2]=s*f*u+a*l,i[4]=o*l,i[5]=a*f*l+s*u,i[6]=s*f*l-a*u,i[8]=-f,i[9]=a*o,i[10]=s*u,this.multiply(e.TMP_MAT)},e.prototype.multiply=function(t){var n=this.m,r=t.m,i=e.TMP;i[0]=n[0]*r[0]+n[4]*r[1]+n[8]*r[2]+n[12]*r[3],i[4]=n[0]*r[4]+n[4]*r[5]+n[8]*r[6]+n[12]*r[7],i[8]=n[0]*r[8]+n[4]*r[9]+n[8]*r[10]+n[12]*r[11],i[12]=n[0]*r[12]+n[4]*r[13]+n[8]*r[14]+n[12]*r[15],i[1]=n[1]*r[0]+n[5]*r[1]+n[9]*r[2]+n[13]*r[3],i[5]=n[1]*r[4]+n[5]*r[5]+n[9]*r[6]+n[13]*r[7],i[9]=n[1]*r[8]+n[5]*r[9]+n[9]*r[10]+n[13]*r[11],i[13]=n[1]*r[12]+n[5]*r[13]+n[9]*r[14]+n[13]*r[15],i[2]=n[2]*r[0]+n[6]*r[1]+n[10]*r[2]+n[14]*r[3],i[6]=n[2]*r[4]+n[6]*r[5]+n[10]*r[6]+n[14]*r[7],i[10]=n[2]*r[8]+n[6]*r[9]+n[10]*r[10]+n[14]*r[11],i[14]=n[2]*r[12]+n[6]*r[13]+n[10]*r[14]+n[14]*r[15],i[3]=n[3]*r[0]+n[7]*r[1]+n[11]*r[2]+n[15]*r[3],i[7]=n[3]*r[4]+n[7]*r[5]+n[11]*r[6]+n[15]*r[7],i[11]=n[3]*r[8]+n[7]*r[9]+n[11]*r[10]+n[15]*r[11],i[15]=n[3]*r[12]+n[7]*r[13]+n[11]*r[14]+n[15]*r[15];for(var s=0;s<16;++s)n[s]=i[s];return this},e.prototype.multiplyVector=function(e,t){var n=this.m;return t.x=e.x*n[0]+e.y*n[1]+e.z*n[2]+n[3],t.y=e.x*n[4]+e.y*n[5]+e.z*n[6]+n[7],t.z=e.x*n[8]+e.y*n[9]+e.z*n[10]+n[11],t},e.prototype.transpose=function(t){var n=this.m,r=t.m,i=e.TMP;i[0]=r[0],i[4]=r[1],i[8]=r[2],i[12]=r[3],i[1]=r[4],i[5]=r[5],i[9]=r[6],i[13]=r[7],i[2]=r[8],i[6]=r[9],i[10]=r[10],i[14]=r[11],i[3]=r[12],i[7]=r[13],i[11]=r[14],i[15]=r[15];for(var s=0;s<16;++s)n[s]=i[s];return this},e.prototype.identify=function(){var e=this.m;return e[0]=1,e[4]=0,e[8]=0,e[12]=0,e[1]=0,e[5]=1,e[9]=0,e[13]=0,e[2]=0,e[6]=0,e[10]=1,e[14]=0,e[3]=0,e[7]=0,e[11]=0,e[15]=1,this},e.prototype.invert=function(){var t=e.TMP,n=this.m,r=n[3]*n[6]*n[9]*n[12]-n[2]*n[7]*n[9]*n[12]-n[3]*n[5]*n[10]*n[12]+n[1]*n[7]*n[10]*n[12]+n[2]*n[5]*n[11]*n[12]-n[1]*n[6]*n[11]*n[12]-n[3]*n[6]*n[8]*n[13]+n[2]*n[7]*n[8]*n[13]+n[3]*n[4]*n[10]*n[13]-n[0]*n[7]*n[10]*n[13]-n[2]*n[4]*n[11]*n[13]+n[0]*n[6]*n[11]*n[13]+n[3]*n[5]*n[8]*n[14]-n[1]*n[7]*n[8]*n[14]-n[3]*n[4]*n[9]*n[14]+n[0]*n[7]*n[9]*n[14]+n[1]*n[4]*n[11]*n[14]-n[0]*n[5]*n[11]*n[14]-n[2]*n[5]*n[8]*n[15]+n[1]*n[6]*n[8]*n[15]+n[2]*n[4]*n[9]*n[15]-n[0]*n[6]*n[9]*n[15]-n[1]*n[4]*n[10]*n[15]+n[0]*n[5]*n[10]*n[15];if(r==0)return!1;var i=1/r;return t[0]=n[9]*n[14]*n[7]-n[13]*n[10]*n[7]+n[13]*n[6]*n[11]-n[5]*n[14]*n[11]-n[9]*n[6]*n[15]+n[5]*n[10]*n[15],t[4]=n[12]*n[10]*n[7]-n[8]*n[14]*n[7]-n[12]*n[6]*n[11]+n[4]*n[14]*n[11]+n[8]*n[6]*n[15]-n[4]*n[10]*n[15],t[8]=n[8]*n[13]*n[7]-n[12]*n[9]*n[7]+n[12]*n[5]*n[11]-n[4]*n[13]*n[11]-n[8]*n[5]*n[15]+n[4]*n[9]*n[15],t[12]=n[12]*n[9]*n[6]-n[8]*n[13]*n[6]-n[12]*n[5]*n[10]+n[4]*n[13]*n[10]+n[8]*n[5]*n[14]-n[4]*n[9]*n[14],t[1]=n[13]*n[10]*n[3]-n[9]*n[14]*n[3]-n[13]*n[2]*n[11]+n[1]*n[14]*n[11]+n[9]*n[2]*n[15]-n[1]*n[10]*n[15],t[5]=n[8]*n[14]*n[3]-n[12]*n[10]*n[3]+n[12]*n[2]*n[11]-n[0]*n[14]*n[11]-n[8]*n[2]*n[15]+n[0]*n[10]*n[15],t[9]=n[12]*n[9]*n[3]-n[8]*n[13]*n[3]-n[12]*n[1]*n[11]+n[0]*n[13]*n[11]+n[8]*n[1]*n[15]-n[0]*n[9]*n[15],t[13]=n[8]*n[13]*n[2]-n[12]*n[9]*n[2]+n[12]*n[1]*n[10]-n[0]*n[13]*n[10]-n[8]*n[1]*n[14]+n[0]*n[9]*n[14],t[2]=n[5]*n[14]*n[3]-n[13]*n[6]*n[3]+n[13]*n[2]*n[7]-n[1]*n[14]*n[7]-n[5]*n[2]*n[15]+n[1]*n[6]*n[15],t[6]=n[12]*n[6]*n[3]-n[4]*n[14]*n[3]-n[12]*n[2]*n[7]+n[0]*n[14]*n[7]+n[4]*n[2]*n[15]-n[0]*n[6]*n[15],t[10]=n[4]*n[13]*n[3]-n[12]*n[5]*n[3]+n[12]*n[1]*n[7]-n[0]*n[13]*n[7]-n[4]*n[1]*n[15]+n[0]*n[5]*n[15],t[14]=n[12]*n[5]*n[2]-n[4]*n[13]*n[2]-n[12]*n[1]*n[6]+n[0]*n[13]*n[6]+n[4]*n[1]*n[14]-n[0]*n[5]*n[14],t[3]=n[9]*n[6]*n[3]-n[5]*n[10]*n[3]-n[9]*n[2]*n[7]+n[1]*n[10]*n[7]+n[5]*n[2]*n[11]-n[1]*n[6]*n[11],t[7]=n[4]*n[10]*n[3]-n[8]*n[6]*n[3]+n[8]*n[2]*n[7]-n[0]*n[10]*n[7]-n[4]*n[2]*n[11]+n[0]*n[6]*n[11],t[11]=n[8]*n[5]*n[3]-n[4]*n[9]*n[3]-n[8]*n[1]*n[7]+n[0]*n[9]*n[7]+n[4]*n[1]*n[11]-n[0]*n[5]*n[11],t[15]=n[4]*n[9]*n[2]-n[8]*n[5]*n[2]+n[8]*n[1]*n[6]-n[0]*n[9]*n[6]-n[4]*n[1]*n[10]+n[0]*n[5]*n[10],n[0]=t[0]*i,n[4]=t[4]*i,n[8]=t[8]*i,n[12]=t[12]*i,n[1]=t[1]*i,n[5]=t[5]*i,n[9]=t[9]*i,n[13]=t[13]*i,n[2]=t[2]*i,n[6]=t[6]*i,n[10]=t[10]*i,n[14]=t[14]*i,n[3]=t[3]*i,n[7]=t[7]*i,n[11]=t[11]*i,n[15]=t[15]*i,!0},e.prototype.determinant=function(){var e=this.m;return e[3]*e[6]*e[9]*e[12]-e[2]*e[7]*e[9]*e[12]-e[3]*e[5]*e[10]*e[12]+e[1]*e[7]*e[10]*e[12]+e[2]*e[5]*e[11]*e[12]-e[1]*e[6]*e[11]*e[12]-e[3]*e[6]*e[8]*e[13]+e[2]*e[7]*e[8]*e[13]+e[3]*e[4]*e[10]*e[13]-e[0]*e[7]*e[10]*e[13]-e[2]*e[4]*e[11]*e[13]+e[0]*e[6]*e[11]*e[13]+e[3]*e[5]*e[8]*e[14]-e[1]*e[7]*e[8]*e[14]-e[3]*e[4]*e[9]*e[14]+e[0]*e[7]*e[9]*e[14]+e[1]*e[4]*e[11]*e[14]-e[0]*e[5]*e[11]*e[14]-e[2]*e[5]*e[8]*e[15]+e[1]*e[6]*e[8]*e[15]+e[2]*e[4]*e[9]*e[15]-e[0]*e[6]*e[9]*e[15]-e[1]*e[4]*e[10]*e[15]+e[0]*e[5]*e[10]*e[15]},e.prototype.projection=function(e,t,n,r){var i=this.m;this.identify();var s=1/Math.tan(n*(Math.PI/180)/2),o=(t+e)/(e-t),u=2*t*e/(e-t);return i[0]=s/r,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=s,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=o,i[11]=-1,i[12]=0,i[13]=0,i[14]=u,i[15]=0,this},e.prototype.viewport=function(e,t){var n=this.m;return this.identify(),n[0]=e/2,n[5]=-t/2,n[12]=e/2,n[13]=t/2,this},e.prototype.ortho=function(e,t,n,r,i,s){var o=this.m;this.identify();var u=2/(t-e),a=2/(r-n),f=-2/(s-i),l=-(t+e)/(t-e),c=-(r+n)/(r-n),h=-(s+i)/(s-i);o[0]=u,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=a,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=f,o[11]=0,o[12]=l,o[13]=c,o[14]=h,o[15]=1},e.prototype.scale=function(e,t,n){var r=this.m;return r[0]*=e,r[5]*=t,r[10]*=n,this},e}();e.Matrix4=t})(volksoper||(volksoper={}));var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},volksoper;(function(e){var t=function(t){function n(){t.apply(this,arguments),this._dirty=!0,this._localMatrix=new e.Matrix4,this.alpha=1,this.touchEnabled=!0,this._x=0,this._y=0,this._z=0,this.width=0,this.height=0,this._rotation=0,this._rotationX=0,this._rotationY=0,this._scaleX=1,this._scaleY=1,this.visible=!0}return __extends(n,t),Object.defineProperty(n.prototype,"localMatrix",{get:function(){var e=this._localMatrix;if(this._dirty){this._dirty=!1;var t=this.pivotX||0,n=this.pivotY||0;e.identify().translate(t+this.x,n+this.y,0).rotate(this.rotationX,this.rotationY,this.rotation).scale(this.scaleX,this.scaleY,1).translate(-t,-n,0)}return e},enumerable:!0,configurable:!0}),n.prototype.hitTestLocal=function(e,t){return 0<=e&&e<=this.width&&0<=t&&t<=this.height},n.prototype.hitTest=function(e,t){var n=this.globalToLocal(e,t);return this.hitTestLocal(n.x,n.y)},n.prototype.getWorldMatrix=function(t){var n=this.parent;return t||(t=new e.Matrix4),n&&n.getWorldMatrix&&n.getWorldMatrix(t),t.multiply(this.localMatrix),t},n.prototype.globalToLocal=function(e,t){var n=this.getWorldMatrix(),r=n.m;return n.invert()?{x:e*r[0]+t*r[1]+r[3],y:e*r[4]+t*r[5]+r[7]}:{x:e,y:t}},Object.defineProperty(n.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"z",{get:function(){return this._z},set:function(e){this._z=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"pivotX",{get:function(){return this._pivotX},set:function(e){this._pivotX=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"pivotY",{get:function(){return this._pivotY},set:function(e){this._pivotY=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"rotation",{get:function(){return this._rotation},set:function(e){this._rotation=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"rotationX",{get:function(){return this._rotationX},set:function(e){this._rotationX=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"rotationY",{get:function(){return this._rotationY},set:function(e){this._rotationY=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scaleX",{get:function(){return this._scaleX},set:function(e){this._scaleX=e,this._dirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scaleY",{get:function(){return this._scaleY},set:function(e){this._scaleY=e,this._dirty=!0},enumerable:!0,configurable:!0}),n}(e.Actor);e.DisplayObject=t})(volksoper||(volksoper={}));var volksoper;(function(e){(function(t){function n(e,t,n,r){return n*e/r+t}function r(e,t,n,r){return n*(.5-Math.cos(e/r*Math.PI)/2)+t}function i(e,t,n,r){return n*(e/=r)*e+t}function s(e,t,n,r){return-n*(e/=r)*(e-2)+t}function o(e,t,n,r){return(e/=r/2)<1?n/2*e*e+t:-n/2*(--e*(e-2)-1)+t}function u(e,t,n,r){return n*(e/=r)*e*e+t}function a(e,t,n,r){return n*((e=e/r-1)*e*e+1)+t}function f(e,t,n,r){return(e/=r/2)<1?n/2*e*e*e+t:n/2*((e-=2)*e*e+2)+t}function l(e,t,n,r){return n*(e/=r)*e*e*e+t}function c(e,t,n,r){return-n*((e=e/r-1)*e*e*e-1)+t}function h(e,t,n,r){return(e/=r/2)<1?n/2*e*e*e*e+t:-n/2*((e-=2)*e*e*e-2)+t}function p(e,t,n,r){return n*(e/=r)*e*e*e*e+t}function d(e,t,n,r){return n*((e=e/r-1)*e*e*e*e+1)+t}function v(e,t,n,r){return(e/=r/2)<1?n/2*e*e*e*e*e+t:n/2*((e-=2)*e*e*e*e+2)+t}function m(e,t,n,r){return-n*Math.cos(e/r*(Math.PI/2))+n+t}function g(e,t,n,r){return n*Math.sin(e/r*(Math.PI/2))+t}function y(e,t,n,r){return-n/2*(Math.cos(Math.PI*e/r)-1)+t}function b(e,t,n,r){return-n*(Math.sqrt(1-(e/=r)*e)-1)+t}function w(e,t,n,r){return n*Math.sqrt(1-(e=e/r-1)*e)+t}function E(e,t,n,r){return(e/=r/2)<1?-n/2*(Math.sqrt(1-e*e)-1)+t:n/2*(Math.sqrt(1-(e-=2)*e)+1)+t}function S(e,t,n,r){if(e===0)return t;if((e/=r)===1)return t+n;var i=r*.3,s=n,o=i/4;return-(s*Math.pow(2,10*(e-=1))*Math.sin((e*r-o)*2*Math.PI/i))+t}function x(e,t,n,r){if(e===0)return t;if((e/=r)===1)return t+n;var i=r*.3,s=n,o=i/4;return s*Math.pow(2,-10*e)*Math.sin((e*r-o)*2*Math.PI/i)+n+t}function T(e,t,n,r){if(e===0)return t;if((e/=r/2)===2)return t+n;var i=r*.3*1.5,s=n,o=i/4;return e<1?-0.5*s*Math.pow(2,10*(e-=1))*Math.sin((e*r-o)*2*Math.PI/i)+t:s*Math.pow(2,-10*(e-=1))*Math.sin((e*r-o)*2*Math.PI/i)*.5+n+t}function N(t,n,r,i){return r-e.Easing.BOUNCE_EASEOUT(i-t,0,r,i)+n}function C(e,t,n,r){return(e/=r)<1/2.75?n*7.5625*e*e+t:e<2/2.75?n*(7.5625*(e-=1.5/2.75)*e+.75)+t:e<2.5/2.75?n*(7.5625*(e-=2.25/2.75)*e+.9375)+t:n*(7.5625*(e-=2.625/2.75)*e+.984375)+t}function k(t,n,r,i){return t<i/2?e.Easing.BOUNCE_EASEIN(t*2,0,r,i)*.5+n:e.Easing.BOUNCE_EASEOUT(t*2-i,0,r,i)*.5+r*.5+n}function L(e,t,n,r){var i=1.70158;return n*(e/=r)*e*((i+1)*e-i)+t}function A(e,t,n,r){var i=1.70158;return n*((e=e/r-1)*e*((i+1)*e+i)+1)+t}function O(e,t,n,r){var i=1.70158;return(e/=r/2)<1?n/2*e*e*(((i*=1.525)+1)*e-i)+t:n/2*((e-=2)*e*(((i*=1.525)+1)*e+i)+2)+t}function M(e,t,n,r){return e===0?t:n*Math.pow(2,10*(e/r-1))+t}function _(e,t,n,r){return e===r?t+n:n*(-Math.pow(2,-10*e/r)+1)+t}function D(e,t,n,r){return e===0?t:e===r?t+n:(e/=r/2)<1?n/2*Math.pow(2,10*(e-1))+t:n/2*(-Math.pow(2,-10*--e)+2)+t}t.LINEAR=n,t.SWING=r,t.QUAD_EASEIN=i,t.QUAD_EASEOUT=s,t.QUAD_EASEINOUT=o,t.CUBIC_EASEIN=u,t.CUBIC_EASEOUT=a,t.CUBIC_EASEINOUT=f,t.QUART_EASEIN=l,t.QUART_EASEOUT=c,t.QUART_EASEINOUT=h,t.QUINT_EASEIN=p,t.QUINT_EASEOUT=d,t.QUINT_EASEINOUT=v,t.SIN_EASEIN=m,t.SIN_EASEOUT=g,t.SIN_EASEINOUT=y,t.CIRC_EASEIN=b,t.CIRC_EASEOUT=w,t.CIRC_EASEINOUT=E,t.ELASTIC_EASEIN=S,t.ELASTIC_EASEOUT=x,t.ELASTIC_EASEINOUT=T,t.BOUNCE_EASEIN=N,t.BOUNCE_EASEOUT=C,t.BOUNCE_EASEINOUT=k,t.BACK_EASEIN=L,t.BACK_EASEOUT=A,t.BACK_EASEINOUT=O,t.EXPO_EASEIN=M,t.EXPO_EASEOUT=_,t.EXPO_EASEINOUT=D})(e.Easing||(e.Easing={}));var t=e.Easing})(volksoper||(volksoper={}));var volksoper;(function(e){var t=function(e){function t(t,n,r){e.call(this,t),this._keyCode=n,this._keyName=r}return __extends(t,e),t.KEY_DOWN="keyDown",t.KEY_UP="keyUp",Object.defineProperty(t.prototype,"keyCode",{get:function(){return this._keyCode},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"keyName",{get:function(){return this._keyName},enumerable:!0,configurable:!0}),t}(e.Event);e.KeyEvent=t})(volksoper||(volksoper={}));var volksoper;(function(e){var t=function(){function e(){this._listeners=[],this._usable=!1}return Object.defineProperty(e.prototype,"usable",{get:function(){return this._usable},enumerable:!0,configurable:!0}),e.prototype._setUsable=function(){if(!this._usable){this._usable=!0;for(var e=0;e<this._listeners.length;++e)this._listeners[e](this);this._listeners=null}},e.prototype.addUsableListener=function(e){this._listeners?this._listeners.push(e):e(this)},e}();e.Resource=t})(volksoper||(volksoper={}));var volksoper;(function(e){var t=function(t){function n(e,n,r,i){t.call(this,e),this._x=n,this._y=r,this._id=i}return __extends(n,t),n.TOUCH_END="touchEnd",n.TOUCH_START="touchStart",n.TOUCH_MOVE="touchMove",n.TOUCH_CANCEL="touchCancel",Object.defineProperty(n.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"localX",{get:function(){return this._localPosition?this._localPosition.x:this._getLocal().x},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"localY",{get:function(){return this._localPosition?this._localPosition.y:this._getLocal().y},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),n.prototype._getLocal=function(){return this._currentTarget instanceof e.DisplayObject?this._localPosition=this._currentTarget.globalToLocal(this._x,this._y):this._localPosition={x:this._x,y:this._y},this._localPosition},Object.defineProperty(n.prototype,"currentTarget",{get:function(){return this._currentTarget},set:function(e){this._currentTarget=e,this._localPosition=null},enumerable:!0,configurable:!0}),n}(e.Event);e.TouchEvent=t})(volksoper||(volksoper={}));var volksoper;(function(e){var t=function(t){function n(n){t.call(this),this._ready=!1,this._running=!1,this._touchReceivers={},this._width=n.width||320,this._height=n.height||320,this._fps=n.fps,this._scale=n.scale||1,this._autoScale=n.autoScale||!1,this._keyMap=n.keys||{};var r=this,i=function(t){t.target.broadcastEvent(new e.Event(e.Event.ADDED_TO_STAGE),r)},s=function(t){t.target.broadcastEvent(new e.Event(e.Event.REMOVE_FROM_STAGE),r)};this.addEventListener(e.Event.ADDED,i,!0,e.SYSTEM_PRIORITY),this.addEventListener(e.Event.REMOVE,s,!0,e.SYSTEM_PRIORITY)}return __extends(n,t),Object.defineProperty(n.prototype,"ready",{get:function(){return this._ready},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"running",{get:function(){return this._running},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"fps",{get:function(){return this._fps},set:function(e){this._fps=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scale",{get:function(){return this._scale},set:function(e){this._scale=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"autoScale",{get:function(){return this._autoScale},set:function(e){this._autoScale=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"keyMap",{get:function(){return this._keyMap},enumerable:!0,configurable:!0}),n.prototype.registerTouchReceiver=function(e,t){this._touchReceivers[t]=e},n.prototype.unregisterTouchReceiver=function(e){delete this._touchReceivers[e]},n.prototype.propagateTouchEvent=function(t,n,r,i){var s=[],o=[],u=[],a=this._touchReceivers[i];if(!a)var a=this._findTouch(this.topChild,n,r);return a&&a.propagateEvent(new e.TouchEvent(t,n,r,i)),a},n.prototype.broadcastKeyEvent=function(t,n,r){this.topChild.broadcastEvent(new e.KeyEvent(t,n,r))},n.prototype._findTouch=function(t,n,r){var i=this,s=null;return t.touchEnabled?(t.forEachChild(function(e){return s=i._findTouch(e,n,r),s},!0),s?s:t instanceof e.DisplayObject?t.hitTest(n,r)?t:null:null):null},n.prototype._preRender=function(e){},n.prototype._postRender=function(e){},n.prototype._inRender=function(e){},n.prototype.render=function(){if(!this.visible)return;this._render(this.topChild)},n.prototype._render=function(e){var t=this;if(!e.visible)return;this._preRender(e),this._inRender(e),this.forEachChild(function(e){t._render(e)}),this._postRender(e)},n.prototype._createSurfaceImpl=function(e,t,n,r,i){return null},n.prototype._createLabelImpl=function(e,t,n){return null},n}(e.DisplayObject);e.Stage=t})(volksoper||(volksoper={}));var volksoper;(function(e){function n(){return"volksoper-"+(++t).toString()}var t=0;e.generateUniqueName=n})(volksoper||(volksoper={}));var volksoper;(function(e){var t=function(t){function n(n,r,i,s,o){t.call(this),this._width=n,this._height=r,this._renderer=i,this._primitive=s,this._name=o,this._invalidate=!1,this._referenceCount=0,this._name||(this._name=e.generateUniqueName())}return __extends(n,t),n.prototype.invalidate=function(){if(!this._impl){this._invalidate=!0;return}this._impl.invalidate()},n.prototype.addRef=function(){return this._impl.addRef()},n.prototype.release=function(){return this._impl.release()},Object.defineProperty(n.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),n.prototype._render=function(){this._impl.render()},n.prototype._onStage=function(e){this._impl||(this._impl=e._createSurfaceImpl(this._width,this._height,this._renderer,this._primitive,this._name),this._invalidate&&(this._invalidate=!1,this._impl.invalidate()))},n.prototype.hitTest=function(e,t){return 0<=e&&e<=this._width&&0<=t&&t<=this._height},n}(e.Resource);e.Surface=t})(volksoper||(volksoper={}));var volksoper;(function(e){var t=function(e){function t(t,n,r){e.call(this,t,n,null,!1,r),this._align=0,this._lineGap=0,this._textColor=0}return __extends(t,e),Object.defineProperty(t.prototype,"font",{get:function(){return this._font},set:function(e){this._font=e,this._impl&&this._impl.font(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"align",{get:function(){return this._align},set:function(e){this._align=e,this._impl&&this._impl.align(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lineGap",{get:function(){return this._lineGap},set:function(e){this._lineGap=e,this._impl&&this._impl.lineGap(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textColor",{get:function(){return this._textColor},set:function(e){this._textColor=e,this._impl&&this._impl.textColor(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){this._text=e,this._impl&&this._impl.text(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textWidth",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textHeight",{get:function(){return 0},enumerable:!0,configurable:!0}),t.prototype._onStage=function(e){this._impl||(this._impl=e._createLabelImpl(this.width,this.height,this.name),this._impl.font(this._font),this._impl.lineGap(this._lineGap),this._impl.align(this._align),this._impl.text(this._text),this._impl.textColor(this._textColor))},t}(e.Surface);e.Label=t;var n=function(){function e(e,t,n,r){this.size=e,this.bold=t,this.italic=n,this.face=r}return e}();e.Font=n,function(e){var t=1,n=2,r=4}(e.VerticalAlign||(e.VerticalAlign={}));var r=e.VerticalAlign;(function(e){var t=16,n=32,r=64})(e.HorizontalAlign||(e.HorizontalAlign={}));var i=e.HorizontalAlign})(volksoper||(volksoper={}));var volksoper;(function(e){function t(e){var t=[];return function(n,r){if(r)return t.push(r),!1;while(t.length!=0){if(t[0](n))return!0;t.shift()}return e&&e(),!1}}function n(e){return function(){e()}}function r(){var e=[];return function(t,n){if(n)return e.push(n),!1;for(var r=0;r<e.length;++r)e[r](t)||(e.splice(r,1),r-=1);return e.length!==0}}function i(e,t){var n=!1,r=function(i){t.removeEventListener(e,r),n=!0};return t.addEventListener(e,r),function(){return!n}}function s(e,t,n,r){var i={},s=0;for(var o in t)i[o]=e[o];return function(o){var u=o.consume(n-s),a=null;if(u>=0){s+=u;for(a in t)e[a]=r(s,i[a],t[a],n);return!0}for(a in t)e[a]=t[a];return!1}}function o(e){return function(){return e(),!1}}var u=function(){function u(e,t){this._board=e,this._hero=t,this._state="normal"}return u.prototype._createScenario=function(){if(!this._scenario){this._board._registerStory(this);var e=this;this._scenario=t(function(){e._scenario=null,e._board._unregisterStory(e)})}},u.prototype._addScenario=function(e){this._createScenario();switch(this._state){case"normal":this._scenario(null,e);break;case"and":this._and(null,e),this._state="unknown";break;case"unknown":this._scenario(null,e),this._state="normal"}},u.prototype.wait=function(){var t=r();for(var s=0;s<arguments.length;++s){var o=arguments[s];typeof o=="string"?t(null,i(o,this._hero)):o instanceof e.Story?t(null,o._scenario):t(null,n(o))}return this._addScenario(t),this},u.prototype.then=function(e){return this._addScenario(o(e)),this},u.prototype.waitEvent=function(e,t){return this._addScenario(i(e,t)),this},u.prototype._createTween=function(t,n,r){var i,o,u;if(r.length==1){var a=r[0];i=a.easing||e.Easing.LINEAR,delete a.easing,u=a.time||1,delete a.time,o=a}else i=r[2]||e.Easing.LINEAR,o={},o[r[0]]=r[1];t&&(o=t(o)),this._addScenario(s(n,o,u,i))},u.prototype.tween=function(e){return this._createTween(null,this._hero,arguments),this},u.prototype.tweenBy=function(e){this._createScenario();var t=this._hero;return this._createTween(function(e){for(var n in e)e[n]=e[n]+t[n];return e},t,arguments),this},u.prototype.call=function(e){var t=[];for(var n=0;n<arguments.length-1;n++)t[n]=arguments[n+1];this._createScenario();var r=this._hero;return this._addScenario(function(){return r[e].apply(r,t),!1}),this},Object.defineProperty(u.prototype,"and",{get:function(){switch(this._state){case"normal":this._and=t(null);break;case"and":break;case"unknown":this._state="and"}return this},enumerable:!0,configurable:!0}),u.prototype._update=function(e){this._scenario(e)},u}();e.Story=u})(volksoper||(volksoper={}));var volksoper;(function(e){var t=function(){function e(){this._time=0}return e.prototype.setTime=function(e){this._time=e},e.prototype.consume=function(e){return this._time<e?(this._time=0,this._time-e):(this._time-=e,-1)},e}(),n=function(){function n(){this._stories=[],this._timer=new t,this._unregister=[]}return n.prototype.update=function(e){this._unregister.splice(0),this._timer.setTime(e);for(var t=0;t<this._stories.length;t++)this._stories[t]._update(this._timer);for(var t=0;t<this._unregister.length;++t)this._stories.splice(this._stories.indexOf(this._unregister[t]),1);return this._stories.length==0},n.prototype._registerStory=function(e){var t=this._unregister.indexOf(e);t>=0?this._unregister.splice(t,0):this._stories.push(e)},n.prototype._unregisterStory=function(e){this._unregister.push(e)},n.prototype.story=function(t){return new e.Story(this,t)},Object.defineProperty(n.prototype,"numStories",{get:function(){return this._stories.length},enumerable:!0,configurable:!0}),n}();e.StoryBoard=n})(volksoper||(volksoper={}));var volksoper;(function(e){var t=function(t){function n(){t.call(this),this._registry={},this._execFind=0,this._unregister=[],this._board=new e.StoryBoard;var n=this,r=function(t){n._registerTarget(t.target),t.target.broadcastEvent(new e.Event(e.Event.ADDED_TO_SCENE),n)},i=function(t){t.target.broadcastEvent(new e.Event(e.Event.REMOVE_FROM_SCENE),n),n._unregisterTarget(t.target)};this.addEventListener(e.Event.ADDED,r,!0,e.SYSTEM_PRIORITY),this.addEventListener(e.Event.REMOVE,i,!0,e.SYSTEM_PRIORITY)}return __extends(n,t),Object.defineProperty(n.prototype,"storyBoard",{get:function(){return this._board},enumerable:!0,configurable:!0}),n.prototype._registerTarget=function(e){this._iterateTable(e,function(t){t.push(e)})},n.prototype._iterateTable=function(e,t){var n=e.constructor.group;if(typeof n=="string")this._callbackGroup(n,t);else if(n instanceof Array)for(var r=0;r<n.length;++r)this._callbackGroup(n[r],t)},n.prototype._callbackGroup=function(e,t){var n=this._registry[e];n||(this._registry[e]=n=[]),t(n)},n.prototype._unregisterTarget=function(e){var t=this;this._execFind===0?this._iterateTable(e,function(t){console.log(t.indexOf(e)),t.splice(t.indexOf(e),1)}):this._iterateTable(e,function(n){t._unregister=[n,e]})},n.prototype.find=function(e,t){this._execFind++,this._callbackGroup(e,function(e){var n=e.length;for(var r=0;r<n;++r)t(e[r])}),this._execFind--;if(this._execFind===0){var n=this._unregister,r=n.length;for(var i=0;i<r;++i)n[i][0].splice(n[i][0].indexOf(n[i][1]),1);n.splice(0)}},n}(e.DisplayObject);e.Scene=t})(volksoper||(volksoper={}));var volksoper;(function(e){var t=function(e){function t(t){e.call(this),this._parentDock=t,this._id=0}return __extends(t,e),t.prototype.find=function(e){return null},t.prototype.load=function(){var e=[];for(var t=0;t<arguments.length-0;t++)e[t]=arguments[t+0];return null},t.prototype.play=function(e){return!1},t}(e.Actor);e.SceneDock=t})(volksoper||(volksoper={}));var volksoper;(function(e){var t=function(t){function n(){var n=this;t.call(this),this._onStage=!1;var r=this;this.addEventListener(e.Event.ADDED_TO_SCENE,function(e){r._scene=e.target},!1,e.SYSTEM_PRIORITY),this.addEventListener(e.Event.REMOVE_FROM_SCENE,function(e){r._scene=null}),this.addEventListener(e.Event.ADDED_TO_STAGE,function(e){r._stage=e.target,n._onStage=!0,n._surface&&(n._surface._onStage(r._stage),n._surface.addRef())},!1,e.SYSTEM_PRIORITY),this.addEventListener(e.Event.REMOVE_FROM_STAGE,function(e){r._stage=null,n._onStage=!1,n.surface&&n._surface.release()})}return __extends(n,t),Object.defineProperty(n.prototype,"scene",{get:function(){return this._scene},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"stage",{get:function(){return this._stage},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"story",{get:function(){return this._story?this._story:(this._story=this._scene.storyBoard.story(this),this._story)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"surface",{get:function(){return this._surface},set:function(e){this._onStage?(this._surface&&this._surface.release(),this._surface=e,e._onStage(this._stage),e.addRef()):this._surface=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return this._surface?this._surface.width:0},set:function(e){},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this._surface?this._surface.height:0},set:function(e){},enumerable:!0,configurable:!0}),n.prototype.hitTestLocal=function(e,t){return this._surface?this._surface.hitTest(e,t):!1},n}(e.DisplayObject);e.Sprite=t})(volksoper||(volksoper={}));var volksoper;(function(e){var t=function(t){function n(e){var n=this;t.call(this,e),this._mouseId=0;var r=e.stageId||"volksoper-stage",i=document.getElementById(r);i||(i=document.createElement("div"),i.style.position="absolute",document.body.appendChild(i));var s=window.getComputedStyle(i,""),o=parseInt(s.width),u=parseInt(s.height);o&&u?this.scale=Math.min(o/this.width,u/this.height):(i.style.width=this.width+"px",i.style.height=this.height+"px"),window.onscroll=function(e){var t=i.getBoundingClientRect();n._pageX=window.scrollX||window.pageXOffset+t.left,n._pageY=window.scrollY||window.pageYOffset+t.top},window.onscroll(),this._element=i,this._initListeners()}return __extends(n,t),n.USE_DEFAULT=["input","textarea","select","area"],Object.defineProperty(n.prototype,"pageX",{get:function(){return this._pageX},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"pageY",{get:function(){return this._pageY},enumerable:!0,configurable:!0}),n.prototype._initListeners=function(){var t=this,r=this._element;document.addEventListener("keydown",function(n){t.keyMap[n.keyCode]&&(n.preventDefault(),n.stopPropagation()),t.running&&t.broadcastKeyEvent(e.KeyEvent.KEY_DOWN,n.keyCode,t.keyMap[n.keyCode])},!0),document.addEventListener("keyup",function(n){t.running&&t.broadcastKeyEvent(e.KeyEvent.KEY_UP,n.keyCode,t.keyMap[n.keyCode])},!0);var i=function(e){var r=e.target.tagName.toLowerCase();n.USE_DEFAULT.indexOf(r)>=0&&(e.preventDefault(),t.running||e.stopPropagation())};r.addEventListener("touchstart",i,!0),r.addEventListener("touchmove",i,!0),r.addEventListener("touchend",i,!0),r.addEventListener("touchcancel",i,!0);var s=function(e){return function(r){var i=r.target.tagName.toLowerCase();n.USE_DEFAULT.indexOf(i)>=0&&(e&&t._mouseId++,r.preventDefault(),t.running||r.stopPropagation())}};r.addEventListener("mousedown",s(!0),!0),r.addEventListener("mouseup",s(!1),!0),r.addEventListener("mousemove",s(!1),!0);var o=function(e,n,r){return function(i){var s=i.changedTouches,o=s.length;for(var u=0;u<o;u++){var a=s[u],f=a.identifier,l=(a.pageX-t._pageX)/t.scale,c=(a.pageY-t._pageY)/t.scale,h=t.propagateTouchEvent(e,l,c,f);n&&t.registerTouchReceiver(h,f),r&&t.unregisterTouchReceiver(f)}}};r.addEventListener("touchstart",o(e.TouchEvent.TOUCH_START,!0,!1),!1),r.addEventListener("touchend",o(e.TouchEvent.TOUCH_END,!1,!0),!1),r.addEventListener("touchmove",o(e.TouchEvent.TOUCH_MOVE,!1,!1),!1),r.addEventListener("touchcancel",o(e.TouchEvent.TOUCH_CANCEL,!1,!0),!1);var u=function(e,n,r){return function(i){var s=(i.pageX-t._pageX)/t.scale,o=(i.pageY-t._pageY)/t.scale,u=t._mouseId,a=t.propagateTouchEvent(e,s,o,u);n&&t.registerTouchReceiver(a,u),r&&t.unregisterTouchReceiver(u)}};r.addEventListener("mousedown",u(e.TouchEvent.TOUCH_START,!0,!1),!1),r.addEventListener("mouseup",u(e.TouchEvent.TOUCH_END,!0,!1),!1),r.addEventListener("mousemove",u(e.TouchEvent.TOUCH_MOVE,!0,!1),!1)},n}(e.Stage);e.HTMLStage=t})(volksoper||(volksoper={}));var volksoper;(function(e){var t=function(){function e(){}return e}()})(volksoper||(volksoper={}));var volksoper;(function(e){var t=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.addDirtySurfaceImpl=function(e){},t}(e.SceneDock);e.CanvasSceneDock=t})(volksoper||(volksoper={}));var volksoper;(function(e){var t=function(){function e(e,t,n,r,i,s,o){this._renderer=n,this._primitive=r,this._name=i,this._dock=s,this._renderContext=o,this._referenceCount=0;var u=document.createElement("canvas");u.width=e,u.height=t,u.style.position="absolute",this._element=u,this._context=u.getContext("2d")}return e.prototype.addRef=function(){return++this._referenceCount},e.prototype.release=function(){return--this._referenceCount},e.prototype.count=function(){return this._referenceCount},Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),e.prototype.invalidate=function(){this._primitive||this._dock.addDirtySurfaceImpl(this)},e.prototype.render=function(){this._primitive?this._renderer(this,this._renderContext):this._renderContext.drawImage(this._element,0,0)},e.prototype.renderContent=function(){this._renderer(this,this._context)},e}();e.CanvasSurfaceImpl=t})(volksoper||(volksoper={}));var volksoper;(function(e){var t=function(t){function n(e){t.call(this,e)}return __extends(n,t),Object.defineProperty(n.prototype,"fps",{get:function(){return this._fps},set:function(e){this._fps=e},enumerable:!0,configurable:!0}),n.prototype._preRender=function(e){},n.prototype._postRender=function(e){},n.prototype._render=function(e){},n.prototype._createSurfaceImpl=function(t,n,r,i,s){return new e.CanvasSurfaceImpl(t,n,r,i,s,new e.CanvasSceneDock,null)},n}(e.HTMLStage);e.CanvasStage=t})(volksoper||(volksoper={}));